<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><meta name="generator" content="sphinx-3.2.1, furo 2020.09.28.beta8"/>
        <title>Outro - Raphael McSinyx</title>
      <link rel="stylesheet" href="../_static/fab.css" />
    <link rel="stylesheet" href="../_static/styles/default.css">
    <link rel="stylesheet" href="../_static/pygments.css">
    
<style>
  :root {
    --color-code-background: #f8f8f8;
    --color-code-foreground: #000000;
  
  
    --color-brand-primary: #436e58;
  
    --color-brand-content: #436e58;
  
  
  }
</style>
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script><script src="../_static/jquery.js"></script>
      <script src="../_static/underscore.js"></script>
      
        <script src="../_static/doctools.js" defer></script>
      
        <script src="../_static/language_data.js" defer></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="../_static/scripts/main.js"></script></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="#101010" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>


<div class="page">
  <header class="mobile-header">
    <label class="header-left nav-overlay-icon" for="__navigation">
      <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
    </label>
    <div class="header-center"><div class="brand">Raphael McSinyx</div></div>
    <div class="header-right"></div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/CnX.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Raphael McSinyx</span>
</a><form class="sidebar-search-container" method="get" action="../search.html">
  <input class="sidebar-search" placeholder="Search" name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-tree sidebar-scroll">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../works.html">Free Software Works</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../life/index.html">Meatspace Adventures</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../life/2010.html">Why the Name?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life/2013.html">The Year after the Apocalypse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life/2020.html">The 2020 Experience</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../math/index.html">Bootleg Lambda Calculus</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../math/conseq.html">Infinite Sequences: A Case Study in Functional Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/system.html">System Cascade Connection</a></li>
</ul>
</li>
</ul>

</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="outro">
<h1>Outro<a class="headerlink" href="#outro" title="Permalink to this headline">¶</a></h1>
<blockquote class="epigraph">
<div><div class="line-block">
<div class="line">Steamed fish was amazing, matter of fact</div>
<div class="line">Let me get some jerk chicken to go</div>
<div class="line">Grabbed me one of them lemon pie theories</div>
<div class="line">And let me get some of them benchmarks you theories too</div>
</div>
</div></blockquote>
<div class="section" id="the-look">
<h2>The Look<a class="headerlink" href="#the-look" title="Permalink to this headline">¶</a></h2>
<p>At the time of writing,
<a class="reference external" href="https://github.com/pypa/pip/pull/8771">implementation-wise parallel download is ready</a>:</p>
<script async="" id="asciicast-356704" src="https://asciinema.org/a/356704.js"></script><p>Does this mean I’ve finished everything just-in-time?  This sounds to good
to be true!  And how does it perform?  Welp…</p>
</div>
<div class="section" id="the-benchmark">
<span id="benchmark"></span><h2>The Benchmark<a class="headerlink" href="#the-benchmark" title="Permalink to this headline">¶</a></h2>
<p>Here comes the bad news: under a decent connection to the package index,
using <code class="docutils literal notranslate"><span class="pre">fast-deps</span></code> does not make <code class="docutils literal notranslate"><span class="pre">pip</span></code> faster.  For best comparison,
I will time <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">download</span></code> on the following cases:</p>
<div class="section" id="average-distribution">
<h3>Average Distribution<a class="headerlink" href="#average-distribution" title="Permalink to this headline">¶</a></h3>
<p>For convenience purposes, let’s refer to the commands to be used as follows</p>
<dl class="simple">
<dt>legacy-resolver</dt><dd><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">--no-cache-dir</span> <span class="pre">download</span> <span class="pre">{requirement}</span></code></p>
</dd>
<dt>2020-resolver</dt><dd><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">--use-feature=2020-resolver</span> <span class="pre">--no-cache-dir</span> <span class="pre">download</span> <span class="pre">{requirement}</span></code></p>
</dd>
<dt>fast-deps</dt><dd><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">--use-feature=2020-resolver</span> <span class="pre">--use-feature=fast-deps</span>
<span class="pre">--no-cache-dir</span> <span class="pre">download</span> <span class="pre">{requirement}</span></code></p>
</dd>
</dl>
<p>In the first test, I used <a class="reference external" href="https://www.youtube.com/playlist?list=PLAA9fHINq3sayfxEyZSF2D_rMgDZGyL3N">axuy</a> and obtained the following results</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 41%"/>
<col style="width: 35%"/>
<col style="width: 24%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>legacy-resolver</p></th>
<th class="head"><p>2020-resolver</p></th>
<th class="head"><p>fast-deps</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7.709s</p></td>
<td><p>7.888s</p></td>
<td><p>10.993s</p></td>
</tr>
<tr class="row-odd"><td><p>7.068s</p></td>
<td><p>7.127s</p></td>
<td><p>11.103s</p></td>
</tr>
<tr class="row-even"><td><p>8.556s</p></td>
<td><p>6.972s</p></td>
<td><p>10.496s</p></td>
</tr>
</tbody>
</table></div>
<p>Funny enough, running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">download</span></code> with <code class="docutils literal notranslate"><span class="pre">fast-deps</span></code> in a directory
with downloaded files already took around 7-8 seconds.  This is because
to lazily download a wheel, <code class="docutils literal notranslate"><span class="pre">pip</span></code> has to <a class="reference external" href="https://github.com/pypa/pip/pull/8670">make many requests</a>
which are apparently more expensive than actual data transmission on my network.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With unstable connection to PyPI (for some reason I am not confident enough
to state), this is what I got</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 59%"/>
<col style="width: 41%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>2020-resolver</p></th>
<th class="head"><p>fast-deps</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1m16.134s</p></td>
<td><p>0m54.894s</p></td>
</tr>
<tr class="row-odd"><td><p>1m0.384s</p></td>
<td><p>0m40.753s</p></td>
</tr>
<tr class="row-even"><td><p>0m50.102s</p></td>
<td><p>0m41.988s</p></td>
</tr>
</tbody>
</table></div>
<p>As the connection was <em>unstable</em> and that the majority of <code class="docutils literal notranslate"><span class="pre">pip</span></code> networking
is performed as CI/CD with large and stable bandwidth, I am unsure what this
result is supposed to tell (-;</p>
</div>
</div>
<div class="section" id="large-distribution">
<h3>Large Distribution<a class="headerlink" href="#large-distribution" title="Permalink to this headline">¶</a></h3>
<p>In this test, I used <a class="reference external" href="https://www.tensorflow.org/">TensorFlow</a> as the requirement and obtained
the following figures:</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 41%"/>
<col style="width: 35%"/>
<col style="width: 24%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>legacy-resolver</p></th>
<th class="head"><p>2020-resolver</p></th>
<th class="head"><p>fast-deps</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0m52.135s</p></td>
<td><p>0m58.809s</p></td>
<td><p>1m5.649s</p></td>
</tr>
<tr class="row-odd"><td><p>0m50.641s</p></td>
<td><p>1m14.896s</p></td>
<td><p>1m28.168s</p></td>
</tr>
<tr class="row-even"><td><p>0m49.691s</p></td>
<td><p>1m5.633s</p></td>
<td><p>1m22.131s</p></td>
</tr>
</tbody>
</table></div>
</div>
<div class="section" id="distribution-with-conflicting-dependencies">
<h3>Distribution with Conflicting Dependencies<a class="headerlink" href="#distribution-with-conflicting-dependencies" title="Permalink to this headline">¶</a></h3>
<p>Some requirement that will trigger a decent amount of backtracking by
the current implementation of the new resolver <code class="docutils literal notranslate"><span class="pre">oslo-utils==1.4.0</span></code>:</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 59%"/>
<col style="width: 41%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>2020-resolver</p></th>
<th class="head"><p>fast-deps</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>14.497s</p></td>
<td><p>24.010s</p></td>
</tr>
<tr class="row-odd"><td><p>17.680s</p></td>
<td><p>28.884s</p></td>
</tr>
<tr class="row-even"><td><p>16.541s</p></td>
<td><p>26.333s</p></td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div class="section" id="what-now">
<h2>What Now?<a class="headerlink" href="#what-now" title="Permalink to this headline">¶</a></h2>
<p>I don’t know, to be honest.  At this point I’m feeling I’ve failed my own
(and that of other stakeholders of <code class="docutils literal notranslate"><span class="pre">pip</span></code>) expectation and wasted the time
and effort of <code class="docutils literal notranslate"><span class="pre">pip</span></code>’s maintainers reviewing dozens of PRs I’ve made
in the last three months.</p>
<p>On the bright side, this has been an opportunity for me to explore the codebase
of package manager and discovered various edge cases where the new resolver
has yet to cover (e.g. I’ve just noticed that <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">download</span></code> would save
to-be-discarded distributions, I’ll file an issue on that soon).  Plus I got
to know many new and cool people and idea, which make me a more helpful
individual to work on Python packaging in the future, I hope.</p>
</div>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          
          
        </div>

        <div class="related-information">
          <span class="copyright">Copyright &copy; 2018-2020, Nguyễn Gia Phong</span> |
          Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using
          <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree">
          <ul>
<li><a class="reference internal" href="#">Outro</a><ul>
<li><a class="reference internal" href="#the-look">The Look</a></li>
<li><a class="reference internal" href="#the-benchmark">The Benchmark</a><ul>
<li><a class="reference internal" href="#average-distribution">Average Distribution</a></li>
<li><a class="reference internal" href="#large-distribution">Large Distribution</a></li>
<li><a class="reference internal" href="#distribution-with-conflicting-dependencies">Distribution with Conflicting Dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#what-now">What Now?</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      
      
    </aside>
  </main>
</div>
  </body>
</html>